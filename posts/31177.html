<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"cansult.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="给大家拜个晚年 祝大家狗年快乐 计数器: 19">
<meta property="og:type" content="article">
<meta property="og:title" content="翻车笔记 ZKY 学长的杂题 [杂题, 清奇脑回路]">
<meta property="og:url" content="http://cansult.github.io/posts/31177.html">
<meta property="og:site_name" content="Cansult&#39;s blog">
<meta property="og:description" content="给大家拜个晚年 祝大家狗年快乐 计数器: 19">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-02-11T13:44:10.000Z">
<meta property="article:modified_time" content="2019-04-08T10:13:40.000Z">
<meta property="article:author" content="Cansult Chen">
<meta property="article:tag" content="清奇脑回路">
<meta property="article:tag" content="杂题">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://cansult.github.io/posts/31177.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>翻车笔记 ZKY 学长的杂题 [杂题, 清奇脑回路] | Cansult's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Cansult's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">即使愿望永远无法实现<br/>我也不愿就这样放手</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://cansult.github.io/posts/31177.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Cansult Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cansult's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          翻车笔记 ZKY 学长的杂题 [杂题, 清奇脑回路]
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-02-11 21:44:10" itemprop="dateCreated datePublished" datetime="2019-02-11T21:44:10+08:00">2019-02-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-04-08 18:13:40" itemprop="dateModified" datetime="2019-04-08T18:13:40+08:00">2019-04-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BF%BB%E8%BD%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">翻车笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>给大家拜个晚年 祝大家狗年快乐</p>
<p>计数器:</p>
<h2 id="section"><font color=#b11d23>19</font></h2>
<span id="more"></span>
<p>上学了...还是学校舒服...里面个个都是人才...说话又好听...</p>
<p>zky学长来讲课啦! zky学长好帅啊!</p>
<h3 id="简单题"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3687">简单题</a></h3>
<p><code>bitset</code>优化一下背包就行了, 比手写的好用多了...</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3687</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:2640 ms</span></span><br><span class="line"><span class="comment">    Memory:1948 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (2000000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL unsigned long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">LL ans;</span><br><span class="line">bitset&lt;MAXN&gt; f;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx);</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        f ^= (f &lt;&lt; srx);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">        <span class="keyword">if</span> (f[i])</span><br><span class="line">            ans ^= i;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="preprefix-sum"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3155">Preprefix
sum</a></h3>
<p>维护前缀和然后区间修改区间查询就完事了</p>
<p>当然也可以推一波式子...和树状数组维护区间的感觉差不多...</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3155</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:672 ms</span></span><br><span class="line"><span class="comment">    Memory:11840 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LS(dq) ((dq) &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RS(dq) (LS(dq) + 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> le, ri;</span><br><span class="line">    LL zh, lazy;</span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> n, a[MAXN];</span><br><span class="line">LL f[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">js</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    b[dq].le = le, b[dq].ri = ri, b[dq].zh = f[le];</span><br><span class="line">    <span class="keyword">if</span> (le == ri) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mi = (le + ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">js</span>(<span class="built_in">LS</span>(dq), le, mi), <span class="built_in">js</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri);</span><br><span class="line">    b[dq].zh = b[<span class="built_in">LS</span>(dq)].zh + b[<span class="built_in">RS</span>(dq)].zh;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_down</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    LL zh = b[dq].lazy;</span><br><span class="line">    b[<span class="built_in">LS</span>(dq)].lazy += zh, b[<span class="built_in">RS</span>(dq)].lazy += zh;</span><br><span class="line">    b[<span class="built_in">LS</span>(dq)].zh += (b[<span class="built_in">LS</span>(dq)].ri - b[<span class="built_in">LS</span>(dq)].le + <span class="number">1</span>) * zh;</span><br><span class="line">    b[<span class="built_in">RS</span>(dq)].zh += (b[<span class="built_in">RS</span>(dq)].ri - b[<span class="built_in">RS</span>(dq)].le + <span class="number">1</span>) * zh;</span><br><span class="line">    b[dq].lazy = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xg</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri, <span class="type">int</span> zh)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri) &#123;</span><br><span class="line">        b[dq].zh += (LL)(ri - le + <span class="number">1</span>) * zh;</span><br><span class="line">        b[dq].lazy += zh;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].lazy) <span class="built_in">push_down</span>(dq);</span><br><span class="line">    <span class="keyword">if</span> (le &gt; mi) <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ri &lt;= mi) <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, mi, zh), <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri, zh);</span><br><span class="line">    b[dq].zh = b[<span class="built_in">LS</span>(dq)].zh + b[<span class="built_in">RS</span>(dq)].zh;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">cx</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri)</span><br><span class="line">        <span class="keyword">return</span> b[dq].zh;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].lazy) <span class="built_in">push_down</span>(dq);</span><br><span class="line">    <span class="keyword">if</span> (le &gt; mi) <span class="keyword">return</span> <span class="built_in">cx</span>(<span class="built_in">RS</span>(dq), le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ri &lt;= mi) <span class="keyword">return</span> <span class="built_in">cx</span>(<span class="built_in">LS</span>(dq), le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">cx</span>(<span class="built_in">LS</span>(dq), le, mi) + <span class="built_in">cx</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), f[i] = f[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="built_in">js</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="type">char</span> srs[<span class="number">10</span> + <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, srs);</span><br><span class="line">        <span class="keyword">if</span> (srs[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx), <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">cx</span>(<span class="number">1</span>, <span class="number">1</span>, srx));</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">xg</span>(<span class="number">1</span>, srx, n, sry - a[srx]), a[srx] = sry;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="jsoi2009等差数列"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=1558">[JSOI2009]等差数列</a></h3>
<p>这题...呕...</p>
<p>一看到是等差 显然要对区间差分 我一看等差数列差分完不就都相等了吗
那不就是求区间颜色个数吗</p>
<p>写写写...这答案怎么都比标准答案...似乎...大了一倍?</p>
<p>后来才发现首项的问题...才发现这题真相在哪...</p>
<p>就是合并的时候注意是否可能前一个区间的最后一个数是后一个区间的首项
然后就完事了</p>
<p>至于转移为什么维护4个值...就是你写着写着发现维护少了写不出来...</p>
<p>那四个值的含义其实就是对于当前区间
可以去掉两边的值后的答案(去掉的那个值就给旁边的区间当首项了)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 1558</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:3520 ms</span></span><br><span class="line"><span class="comment">    Memory:15744 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LS(dq) ((dq) &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RS(dq) (LS(dq) | 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> le, ri, lc, rc, ans[<span class="number">4</span>], lazy; <span class="comment">// 0: l和r都不在等差数列中; 1: l在等差数列中; 2: r在等差数列中; 3: l和r都在等差数列中</span></span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> a[MAXN], n;</span><br><span class="line"><span class="function">node <span class="title">push_up</span><span class="params">(node le, node ri)</span> </span>&#123;</span><br><span class="line">    node re;</span><br><span class="line">    re.lazy = <span class="number">0</span>;</span><br><span class="line">    re.le = le.le, re.ri = ri.ri;</span><br><span class="line">    re.lc = le.lc, re.rc = ri.rc;</span><br><span class="line"> </span><br><span class="line">    re.ans[<span class="number">0</span>] = le.ans[<span class="number">2</span>] + ri.ans[<span class="number">1</span>] - (le.rc == ri.lc);</span><br><span class="line">    re.ans[<span class="number">0</span>] = <span class="built_in">min</span>(re.ans[<span class="number">0</span>], le.ans[<span class="number">0</span>] + ri.ans[<span class="number">1</span>]);</span><br><span class="line">    re.ans[<span class="number">0</span>] = <span class="built_in">min</span>(re.ans[<span class="number">0</span>], le.ans[<span class="number">2</span>] + ri.ans[<span class="number">0</span>]);</span><br><span class="line"> </span><br><span class="line">    re.ans[<span class="number">1</span>] = le.ans[<span class="number">3</span>] + ri.ans[<span class="number">1</span>] - (le.rc == ri.lc);</span><br><span class="line">    re.ans[<span class="number">1</span>] = <span class="built_in">min</span>(re.ans[<span class="number">1</span>], le.ans[<span class="number">1</span>] + ri.ans[<span class="number">1</span>]);</span><br><span class="line">    re.ans[<span class="number">1</span>] = <span class="built_in">min</span>(re.ans[<span class="number">1</span>], le.ans[<span class="number">3</span>] + ri.ans[<span class="number">0</span>]);</span><br><span class="line"> </span><br><span class="line">    re.ans[<span class="number">2</span>] = le.ans[<span class="number">2</span>] + ri.ans[<span class="number">3</span>] - (le.rc == ri.lc);</span><br><span class="line">    re.ans[<span class="number">2</span>] = <span class="built_in">min</span>(re.ans[<span class="number">2</span>], le.ans[<span class="number">0</span>] + ri.ans[<span class="number">3</span>]);</span><br><span class="line">    re.ans[<span class="number">2</span>] = <span class="built_in">min</span>(re.ans[<span class="number">2</span>], le.ans[<span class="number">2</span>] + ri.ans[<span class="number">2</span>]);</span><br><span class="line"> </span><br><span class="line">    re.ans[<span class="number">3</span>] = le.ans[<span class="number">3</span>] + ri.ans[<span class="number">3</span>] - (le.rc == ri.lc);</span><br><span class="line">    re.ans[<span class="number">3</span>] = <span class="built_in">min</span>(re.ans[<span class="number">3</span>], le.ans[<span class="number">3</span>] + ri.ans[<span class="number">2</span>]);</span><br><span class="line">    re.ans[<span class="number">3</span>] = <span class="built_in">min</span>(re.ans[<span class="number">3</span>], le.ans[<span class="number">1</span>] + ri.ans[<span class="number">3</span>]);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">js</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    b[dq].le = le, b[dq].ri = ri, b[dq].lazy = <span class="number">0</span>, b[dq].lc = b[dq].rc = a[le];</span><br><span class="line">    b[dq].ans[<span class="number">3</span>] = b[dq].ans[<span class="number">2</span>] = b[dq].ans[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    b[dq].ans[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (le == ri) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mi = (le + ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">js</span>(<span class="built_in">LS</span>(dq), le, mi), <span class="built_in">js</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri);</span><br><span class="line">    b[dq] = <span class="built_in">push_up</span>(b[<span class="built_in">LS</span>(dq)], b[<span class="built_in">RS</span>(dq)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_down</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> zh = b[dq].lazy;</span><br><span class="line">    b[<span class="built_in">LS</span>(dq)].lazy += zh, b[<span class="built_in">LS</span>(dq)].lc += zh, b[<span class="built_in">LS</span>(dq)].rc += zh;</span><br><span class="line">    b[<span class="built_in">RS</span>(dq)].lazy += zh, b[<span class="built_in">RS</span>(dq)].lc += zh, b[<span class="built_in">RS</span>(dq)].rc += zh;</span><br><span class="line">    b[dq].lazy = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xg</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri, <span class="type">int</span> zh)</span> </span>&#123;</span><br><span class="line">    le = <span class="built_in">max</span>(le, <span class="number">1</span>), ri = <span class="built_in">min</span>(ri, n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (le &gt; ri) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri) &#123;</span><br><span class="line">        b[dq].lc += zh, b[dq].rc += zh;</span><br><span class="line">        b[dq].lazy += zh;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].lazy) <span class="built_in">push_down</span>(dq);</span><br><span class="line">    <span class="keyword">if</span> (le &gt; mi) <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ri &lt;= mi) <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, mi, zh), <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri, zh);</span><br><span class="line">    b[dq] = <span class="built_in">push_up</span>(b[<span class="built_in">LS</span>(dq)], b[<span class="built_in">RS</span>(dq)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">node <span class="title">cx</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri)</span><br><span class="line">        <span class="keyword">return</span> b[dq];</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].lazy) <span class="built_in">push_down</span>(dq);</span><br><span class="line">    <span class="keyword">if</span> (le &gt; mi) <span class="keyword">return</span> <span class="built_in">cx</span>(<span class="built_in">RS</span>(dq), le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ri &lt;= mi) <span class="keyword">return</span> <span class="built_in">cx</span>(<span class="built_in">LS</span>(dq), le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">push_up</span>(<span class="built_in">cx</span>(<span class="built_in">LS</span>(dq), le, mi), <span class="built_in">cx</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) a[i] = a[i + <span class="number">1</span>] - a[i];</span><br><span class="line">    <span class="built_in">js</span>(<span class="number">1</span>, <span class="number">1</span>, n - <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">    <span class="type">char</span> srs[<span class="number">10</span> + <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry, sra, srb; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, srs);</span><br><span class="line">        <span class="keyword">if</span> (srs[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;srx, &amp;sry, &amp;sra, &amp;srb);</span><br><span class="line">            <span class="built_in">xg</span>(<span class="number">1</span>, srx - <span class="number">1</span>, srx - <span class="number">1</span>, sra);</span><br><span class="line">            <span class="built_in">xg</span>(<span class="number">1</span>, srx, sry - <span class="number">1</span>, srb);</span><br><span class="line">            <span class="built_in">xg</span>(<span class="number">1</span>, sry, sry, -sra - (sry - srx) * srb);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (srx == sry) ? <span class="number">1</span> : <span class="built_in">cx</span>(<span class="number">1</span>, srx, sry - <span class="number">1</span>).ans[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="poi2010intelligence-test"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=2083">[Poi2010]Intelligence
test</a></h3>
<p>这题...众(不包括我)所周知这种一个数(<span
class="math inline">\(n\)</span>)特别大的情况, 就尽量只扫一遍<span
class="math inline">\(n\)</span></p>
<p>然后...就扫一遍<span
class="math inline">\(n\)</span>....就完事了....</p>
<p>(可以体会一下注释中的代码和AC代码的微妙区别)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 2083</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:7444 ms</span></span><br><span class="line"><span class="comment">    Memory:52752 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (1000000 + 5)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n, m, a[MAXN], len[MAXN];</span><br><span class="line"><span class="type">bool</span> ans[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; b[MAXN], nex[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, dqn; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;dqn);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>, srx; j &lt;= dqn; j++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx), b[i].<span class="built_in">push_back</span>(srx);</span><br><span class="line">        nex[b[i][<span class="number">0</span>]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; bk = nex[a[i]];</span><br><span class="line">        nex[a[i]].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; bk.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            <span class="type">int</span> wz = bk[j];</span><br><span class="line">            ++len[wz];</span><br><span class="line">            <span class="keyword">if</span> (len[wz] &gt;= b[wz].<span class="built_in">size</span>()) ans[wz] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> nex[b[wz][len[wz]]].<span class="built_in">push_back</span>(wz);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">puts</span>(ans[i] ? <span class="string">&quot;TAK&quot;</span> : <span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">#include &lt;cstdio&gt;</span></span><br><span class="line"><span class="comment">#include &lt;vector&gt;</span></span><br><span class="line"><span class="comment">#define MAXN (1000000 + 5)</span></span><br><span class="line"><span class="comment">using namespace std;</span></span><br><span class="line"><span class="comment">int n, m, a[MAXN], len[MAXN];</span></span><br><span class="line"><span class="comment">bool ans[MAXN];</span></span><br><span class="line"><span class="comment">vector&lt;int&gt; b[MAXN], nex[MAXN];</span></span><br><span class="line"><span class="comment">int main() &#123;</span></span><br><span class="line"><span class="comment">	scanf(&quot;%d&quot;, &amp;n);</span></span><br><span class="line"><span class="comment">	for (int i = 1; i &lt;= n; i++) scanf(&quot;%d&quot;, &amp;a[i]);</span></span><br><span class="line"><span class="comment">	int m;</span></span><br><span class="line"><span class="comment">	scanf(&quot;%d&quot;, &amp;m);</span></span><br><span class="line"><span class="comment">	for (int i = 1, dqn; i &lt;= m; i++) &#123;</span></span><br><span class="line"><span class="comment">		scanf(&quot;%d&quot;, &amp;dqn);</span></span><br><span class="line"><span class="comment">		for (int j = 1, srx; j &lt;= dqn; j++)</span></span><br><span class="line"><span class="comment">			scanf(&quot;%d&quot;, &amp;srx), b[i].push_back(srx);</span></span><br><span class="line"><span class="comment">		nex[b[i][0]].push_back(i);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	for (int i = 1; i &lt;= n; i++) &#123;</span></span><br><span class="line"><span class="comment">		vector&lt;int&gt; bk = nex[a[i]];</span></span><br><span class="line"><span class="comment">		nex[a[i]].clear();</span></span><br><span class="line"><span class="comment">		for (int j = 0; j &lt; bk.size(); j++) &#123;</span></span><br><span class="line"><span class="comment">			int wz = bk[j];</span></span><br><span class="line"><span class="comment">			if (len[wz] &gt;= b[wz].size() - 1) continue;</span></span><br><span class="line"><span class="comment">			nex[b[wz][++len[wz]]].push_back(wz);</span></span><br><span class="line"><span class="comment">			if (len[wz] &gt;= b[wz].size() - 1) ans[wz] = true; //这个地方可能只是把下一位push进了vector, 而还没有在a[]中出现过, 所以可能造成有些NIE变成TAK</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	for (int i = 1; i &lt;= m; i++)</span></span><br><span class="line"><span class="comment">		puts(ans[i] ? &quot;TAK&quot; : &quot;NIE&quot;);</span></span><br><span class="line"><span class="comment">	return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="count"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3956">Count</a></h3>
<p>根据影魔的套路
我们发现所谓的好区间就是一个数和他的<code>premax</code>,
<code>nexmax</code></p>
<p>然后就是在给定的区间里看有多少个这样的区间 二维数点 用树套树即可</p>
<p>发现这题没修改 直接用主席树也就做完了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3956</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:3872 ms</span></span><br><span class="line"><span class="comment">    Memory:204608 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (300000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF (0x7fffffff)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> ls, rs, zh, le, ri;</span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> a[MAXN], n, root[MAXN], cntb, bh[MAXN], cntr;</span><br><span class="line">vector&lt;pii&gt; pa;</span><br><span class="line">stack&lt;pii&gt; Gary;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> pre, <span class="type">int</span>&amp; dq, <span class="type">int</span> le, <span class="type">int</span> ri, <span class="type">int</span> zh)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!dq) dq = ++cntb, b[dq].le = le, b[dq].ri = ri, b[dq].ls = b[dq].rs = <span class="number">0</span>, b[dq].zh = b[pre].zh;</span><br><span class="line">    <span class="keyword">if</span> (le == ri) &#123; ++b[dq].zh; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    <span class="type">int</span> mi = (le + ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (zh &lt;= mi) b[dq].rs = (b[dq].rs ? b[dq].rs : b[pre].rs), <span class="built_in">ins</span>(b[pre].ls, b[dq].ls, le, mi, zh);</span><br><span class="line">    <span class="keyword">else</span> b[dq].ls = (b[dq].ls ? b[dq].ls : b[pre].ls), <span class="built_in">ins</span>(b[pre].rs, b[dq].rs, mi + <span class="number">1</span>, ri, zh);</span><br><span class="line">    b[dq].zh = b[b[dq].ls].zh + b[b[dq].rs].zh;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cx</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!dq) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri) <span class="keyword">return</span> b[dq].zh;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (le &gt; mi) <span class="keyword">return</span> <span class="built_in">cx</span>(b[dq].rs, le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ri &lt;= mi) <span class="keyword">return</span> <span class="built_in">cx</span>(b[dq].ls, le, ri);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">cx</span>(b[dq].ls, le, mi) + <span class="built_in">cx</span>(b[dq].rs, mi + <span class="number">1</span>, ri);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Gary.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(INF, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (Gary.<span class="built_in">top</span>().first &lt; a[i]) Gary.<span class="built_in">pop</span>();</span><br><span class="line">        pa.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(Gary.<span class="built_in">top</span>().second, i));</span><br><span class="line">        Gary.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[i], i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!Gary.<span class="built_in">empty</span>()) Gary.<span class="built_in">pop</span>();</span><br><span class="line">    Gary.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(INF, n + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">while</span> (Gary.<span class="built_in">top</span>().first &lt; a[i]) Gary.<span class="built_in">pop</span>();</span><br><span class="line">        pa.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(i, Gary.<span class="built_in">top</span>().second));</span><br><span class="line">        Gary.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(a[i], i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(pa.<span class="built_in">begin</span>(), pa.<span class="built_in">end</span>());</span><br><span class="line">    vector&lt;pii&gt;::iterator te = <span class="built_in">unique</span>(pa.<span class="built_in">begin</span>(), pa.<span class="built_in">end</span>());</span><br><span class="line">    pa.<span class="built_in">erase</span>(te, pa.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> dq = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; pa.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (pa[i].first &lt; <span class="number">1</span> || pa[i].second &gt; n || pa[i].second - pa[i].first &lt;= <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (dq &lt; pa[i].first - <span class="number">1</span>) bh[++dq] = cntr;</span><br><span class="line">        ++cntr;</span><br><span class="line">        <span class="built_in">ins</span>(root[cntr - <span class="number">1</span>], root[cntr], <span class="number">1</span>, n, pa[i].second);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (dq &lt; n) bh[++dq] = cntr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ty, q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;q, &amp;ty);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, lastans = <span class="number">0</span>, srx, sry; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry);</span><br><span class="line">        <span class="keyword">if</span> (ty) &#123;</span><br><span class="line">            srx = (srx + lastans - <span class="number">1</span>) % n + <span class="number">1</span>, sry = (sry + lastans - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (srx &gt; sry) <span class="built_in">swap</span>(srx, sry);</span><br><span class="line">        &#125;</span><br><span class="line">        lastans = <span class="built_in">cx</span>(root[bh[n]], <span class="number">1</span>, sry) - <span class="built_in">cx</span>(root[bh[srx - <span class="number">1</span>]], <span class="number">1</span>, sry) + sry - srx;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lastans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="罗马游戏"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=1455">罗马游戏</a></h3>
<p>可并对板子</p>
<p>忘了在合并的时候判断他们是否已经在一个堆里了 丢人</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 1455</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:2208 ms</span></span><br><span class="line"><span class="comment">    Memory:42308 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (2000000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF (0x7fffffff)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> ls, rs, zh, dis, fa;</span><br><span class="line">&#125; b[MAXN];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">bool</span> hsdie[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y;</span><br><span class="line">    <span class="keyword">if</span> (b[x].zh &gt; b[y].zh) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    b[b[x].rs = <span class="built_in">merge</span>(b[x].rs, y)].fa = b[b[x].ls].fa = x;</span><br><span class="line">    <span class="keyword">if</span> (b[b[x].ls].dis &lt; b[b[x].rs].dis) <span class="built_in">swap</span>(b[x].ls, b[x].rs);</span><br><span class="line">    b[x].dis = b[b[x].rs].dis + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (b[x].fa != x) x = b[x].fa; </span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">uni</span><span class="params">(<span class="type">int</span> fx, <span class="type">int</span> fy)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b[fx].zh &gt; b[fy].zh) b[fy].fa = fy;</span><br><span class="line">    <span class="keyword">else</span> b[fx].fa = fx;</span><br><span class="line">    <span class="built_in">merge</span>(fx, fy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> fx = <span class="built_in">find</span>(x);</span><br><span class="line">    b[fx].zh = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">uni</span>(b[fx].ls, b[fx].rs);</span><br><span class="line">    b[fx].ls = b[fx].rs = <span class="number">0</span>;</span><br><span class="line">    hsdie[fx] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i].zh), b[i].fa = i;</span><br><span class="line">    b[<span class="number">0</span>].zh = INF;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">    <span class="type">char</span> srs[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, srs);</span><br><span class="line">        <span class="keyword">if</span> (srs[<span class="number">0</span>] == <span class="string">&#x27;M&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry);</span><br><span class="line">            <span class="keyword">if</span> (hsdie[srx] || hsdie[sry]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">uni</span>(<span class="built_in">find</span>(srx), <span class="built_in">find</span>(sry));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx);</span><br><span class="line">            <span class="keyword">if</span> (hsdie[srx]) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> &#123; </span><br><span class="line">                <span class="type">int</span> fx = <span class="built_in">find</span>(srx);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, b[fx].zh), <span class="built_in">del</span>(fx);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="tjoi2012-桥"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=4400">tjoi2012
桥</a></h3>
<p>众所周知boss在的边肯定在最短路的那条链上</p>
<p>联想一下<a target="_blank" rel="noopener" href="https://cansult.ga/2897.html">这个题</a>, 考虑枚举边
更新在最短路链上删除边后的收益</p>
<p>对于每一条边, 可以更新的区间是 [起点在以<span
class="math inline">\(s\)</span>为根的最短路树上与<span
class="math inline">\(t\)</span>的LCA, 终点在以<span
class="math inline">\(t\)</span>为根的最短路树上与<span
class="math inline">\(s\)</span>的LCA]</p>
<p>之所以要这么更新
主要是因为我们不知道在是否会删掉这条边后会经过我们枚举的边
所以我们要对这个区间用[经过我们枚举的边的最短路的长度]来取<span
class="math inline">\(\min\)</span></p>
<p>然后最后在最短路链上找值最大的边 就是要删掉的边,
最大值的数量就是方案数</p>
<p>注意特判有两条没有公共边的最短路的情况 这时候无论删掉哪条边答案都不变
方案数要输出总边数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 4400</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:2348 ms</span></span><br><span class="line"><span class="comment">    Memory:15380 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXM (200000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF (0x7ffffff)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LS(dq) ((dq) &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RS(dq) (LS(dq) | 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rev(i) (((i - 1) ^ 1) + 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next, cost;</span><br><span class="line">&#125; tb[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> le, ri, lazy;</span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="type">const</span> pii x, <span class="type">const</span> pii y)</span> </span>&#123; <span class="keyword">return</span> x.second &gt; y.second; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, pre[<span class="number">2</span>][MAXN], g[MAXN], cntb, dis[<span class="number">2</span>][MAXN], ats[MAXN], att[MAXN];</span><br><span class="line"><span class="comment">// pre: 最短路树; ats: 这个点从s为根的最短路树上往上爬能达到的编号; att: 从以t为...的编号</span></span><br><span class="line"><span class="type">bool</span> chosen[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijk</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span>* disx, <span class="type">int</span>* prex)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> vis[MAXN];</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    priority_queue&lt;pii, vector&lt;pii&gt;, cmp&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(s, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) disx[i] =  INF;</span><br><span class="line">    disx[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> dq = q.<span class="built_in">top</span>().first;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (vis[dq]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[dq] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = tb[i].next)</span><br><span class="line">            <span class="keyword">if</span> (disx[tb[i].to] &gt; disx[dq] + tb[i].cost) &#123;</span><br><span class="line">                disx[tb[i].to] = disx[dq] + tb[i].cost;</span><br><span class="line">                prex[tb[i].to] = i;</span><br><span class="line">                q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(tb[i].to, disx[tb[i].to]));</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">js</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri)</span> </span>&#123;</span><br><span class="line">    b[dq].le = le, b[dq].ri = ri, b[dq].lazy = INF;</span><br><span class="line">    <span class="keyword">if</span> (le == ri) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mi = (le + ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">js</span>(<span class="built_in">LS</span>(dq), le, mi), <span class="built_in">js</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xg</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> le, <span class="type">int</span> ri, <span class="type">int</span> zh)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (le &gt; ri) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == le &amp;&amp; b[dq].ri == ri) &#123;</span><br><span class="line">        b[dq].lazy = <span class="built_in">min</span>(b[dq].lazy, zh);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ri &lt;= mi) <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (le &gt; mi) <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), le, ri, zh);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">xg</span>(<span class="built_in">LS</span>(dq), le, mi, zh), <span class="built_in">xg</span>(<span class="built_in">RS</span>(dq), mi + <span class="number">1</span>, ri, zh);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cx</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span> wz)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b[dq].le == b[dq].ri) <span class="keyword">return</span> b[dq].lazy;</span><br><span class="line">    <span class="type">int</span> mi = (b[dq].le + b[dq].ri) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (wz &lt;= mi) <span class="keyword">return</span> <span class="built_in">min</span>(b[dq].lazy, <span class="built_in">cx</span>(<span class="built_in">LS</span>(dq), wz));</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">min</span>(b[dq].lazy, <span class="built_in">cx</span>(<span class="built_in">RS</span>(dq), wz));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dq, <span class="type">int</span>* prex, <span class="type">int</span>* at)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (at[dq]) <span class="keyword">return</span> at[dq];</span><br><span class="line">    <span class="keyword">return</span> (at[dq] = <span class="built_in">dfs</span>(tb[prex[dq]].from, prex, at));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> cnta = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i; i = tb[pre[<span class="number">1</span>][i]].from) ats[i] = att[i] = ++cnta, chosen[pre[<span class="number">1</span>][i]] = chosen[<span class="built_in">rev</span>(pre[<span class="number">1</span>][i])] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; n; i++) </span><br><span class="line">        <span class="keyword">if</span> (!ats[i])</span><br><span class="line">            ats[i] = <span class="built_in">dfs</span>(i, pre[<span class="number">0</span>], ats);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!att[i])</span><br><span class="line">            att[i] = <span class="built_in">dfs</span>(i, pre[<span class="number">1</span>], att);</span><br><span class="line">    <span class="built_in">js</span>(<span class="number">1</span>, <span class="number">1</span>, cnta - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cntb; i += <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> (!chosen[i]) &#123;</span><br><span class="line">            <span class="type">int</span> u = tb[i].from, v = tb[i].to;</span><br><span class="line">            <span class="keyword">if</span> (dis[<span class="number">0</span>][u] &gt; dis[<span class="number">0</span>][v]) <span class="built_in">swap</span>(u, v);</span><br><span class="line">            <span class="built_in">xg</span>(<span class="number">1</span>, ats[u], att[v] - <span class="number">1</span>, dis[<span class="number">0</span>][u] + dis[<span class="number">1</span>][v] + tb[i].cost);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; att[n]; i++)</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, <span class="built_in">cx</span>(<span class="number">1</span>, i));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; att[n]; i++)</span><br><span class="line">        <span class="keyword">if</span> (ans == <span class="built_in">cx</span>(<span class="number">1</span>, i))</span><br><span class="line">            ++cnt;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>, ans, (ans == dis[<span class="number">0</span>][n]) ? m : cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">    tb[++cntb].next = g[from];</span><br><span class="line">    tb[cntb].from = from, tb[cntb].to = to, tb[cntb].cost = cost;</span><br><span class="line">    g[from] = cntb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry, src; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;srx, &amp;sry, &amp;src), <span class="built_in">adn</span>(srx, sry, src), <span class="built_in">adn</span>(sry, srx, src);</span><br><span class="line">    <span class="built_in">dijk</span>(<span class="number">1</span>, dis[<span class="number">0</span>], pre[<span class="number">0</span>]), <span class="built_in">dijk</span>(n, dis[<span class="number">1</span>], pre[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="poi2012warehouse-store"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=2802">[Poi2012]Warehouse
Store</a></h3>
<p>我一开始想二分最大能连续选的商品价值 后来发现剩下的没法处理</p>
<p>考虑有<a
target="_blank" rel="noopener" href="https://cansult.ga/2254.html">一道类似的题</a>...就是删除之前选过的东西</p>
<p>所以...这题我们发现可以...遇到一个不能选的点
看看他的前面能否去掉一个<code>b[x]</code>更大的<code>x</code>,
然后让这个点加入</p>
<p>一定要记得什么类型就用什么输出 我被输出锤自闭了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 2802</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:1144 ms</span></span><br><span class="line"><span class="comment">    Memory:6840 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (250000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="type">const</span> pii x, <span class="type">const</span> pii y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, a[MAXN], b[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; outp;</span><br><span class="line">priority_queue&lt;pii, vector&lt;pii&gt; &gt; q;</span><br><span class="line"><span class="built_in">main</span>() &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]);</span><br><span class="line">    LL dq = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dq += a[i];</span><br><span class="line">        <span class="keyword">if</span> (dq &gt;= b[i]) q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(b[i], i)), dq -= b[i];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">top</span>().first &gt; b[i]) &#123;</span><br><span class="line">                dq += q.<span class="built_in">top</span>().first - b[i];</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">                q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(b[i], i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, q.<span class="built_in">size</span>()); <span class="comment">// 这个地方用lld输出就会出问题</span></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) outp.<span class="built_in">push_back</span>(q.<span class="built_in">top</span>().second), q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="built_in">sort</span>(outp.<span class="built_in">begin</span>(), outp.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; outp.<span class="built_in">size</span>(); i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, outp[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="poi2018prawnicy"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=5102">[POI2018]Prawnicy</a></h3>
<p>我们可以枚举<strong>答案区间</strong>的左端点</p>
<p>然后让左端点在答案区间左边的区间中 右端点尽量靠右就完事了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 2802</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:1144 ms</span></span><br><span class="line"><span class="comment">    Memory:6840 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (250000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="type">const</span> pii x, <span class="type">const</span> pii y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, a[MAXN], b[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; outp;</span><br><span class="line">priority_queue&lt;pii, vector&lt;pii&gt; &gt; q;</span><br><span class="line"><span class="built_in">main</span>() &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]);</span><br><span class="line">    LL dq = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dq += a[i];</span><br><span class="line">        <span class="keyword">if</span> (dq &gt;= b[i]) q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(b[i], i)), dq -= b[i];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">top</span>().first &gt; b[i]) &#123;</span><br><span class="line">                dq += q.<span class="built_in">top</span>().first - b[i];</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">                q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(b[i], i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, q.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) outp.<span class="built_in">push_back</span>(q.<span class="built_in">top</span>().second), q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="built_in">sort</span>(outp.<span class="built_in">begin</span>(), outp.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; outp.<span class="built_in">size</span>(); i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, outp[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="noi2002savage"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=1407">[Noi2002]Savage</a></h3>
<p>首先你要知道 这题数据水的和鳖一样<span class="math inline">\(\mathrm
O(m n^2\lg \mathrm {maxint})\)</span>可过</p>
<p>然后我们可以列式子: 他们如果遇见了 是在什么时候
然后解出来时间之后再和他们的寿命比较一下</p>
<p>然后我发现我似乎之前exGCD都写假了 最小整数解要<span
class="math inline">\(\mod \frac{b}{gcd}\)</span>很真实</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 1407</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:1280 ms</span></span><br><span class="line"><span class="comment">    Memory:1288 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// c[i] + p[i] * x % m == c[j] + p[j] * x % m</span></span><br><span class="line"><span class="comment">// (p[i] - p[j]) * x == c[j] - c[i] &amp;&amp; x &lt;= hp</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (15 + 5)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span>&amp; x, <span class="type">int</span>&amp; y)</span> </span>&#123; <span class="comment">// ax + by == gcd</span></span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (!y) ? x : <span class="built_in">gcd</span>(y, x % y); &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> m, <span class="type">int</span> hp)</span> </span>&#123; <span class="comment">// ax == b (mod m) =&gt; ax + my == b</span></span><br><span class="line">    a = (a % m + m) % m, b = (b % m + m) % m; <span class="comment">// 注意处理负数</span></span><br><span class="line">    <span class="type">int</span> qaq = <span class="built_in">gcd</span>(a, m), x, y;</span><br><span class="line">    <span class="keyword">if</span> (b % qaq) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">exgcd</span>(a, m, x, y);</span><br><span class="line">    x *= b / qaq;</span><br><span class="line">    x %= (m / qaq);</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) x += m / qaq;</span><br><span class="line">    <span class="keyword">return</span> hp &lt; x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, c[MAXN], p[MAXN], l[MAXN];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">solve</span>(p[i] - p[j], c[j] - c[i], m, <span class="built_in">min</span>(l[i], l[j])))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">int</span> minans = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;c[i], &amp;p[i], &amp;l[i]), minans = <span class="built_in">max</span>(minans, c[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = minans; i &lt;= <span class="number">1000000</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">solve</span>(i)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dzy-loves-chinese-ii"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3569">DZY Loves
Chinese II</a></h3>
<p>这题很有意思</p>
<p>建出dfs树, 对于所有的非树边 随机一个权值,
然后将这个非树边在树上的一段区间全部异或上这个权值, 最后得出树边的权值,
这样 对于一次询问
我们只需要判断出这些边是否能异或出0(树边和覆盖ta的非树边都被删掉了)</p>
<p>一开始我想写32棵标记永久化的线段树 然后对每次询问的非树边区间修改
树边单点查询</p>
<p>后来发现直接对这些边建线性基就能看出来是否能异或出0</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3569</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:3368 ms</span></span><br><span class="line"><span class="comment">    Memory:30736 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXM (500000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXL (32 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXK (15 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LS(dq) ((dq) &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RS(dq) (LS(dq) | 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next, bh;</span><br><span class="line">&#125; tb[MAXN], eb[MAXM &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tnode</span> &#123;</span><br><span class="line">    <span class="type">int</span> fa, deep, top, hs, size;</span><br><span class="line">&#125; ta[MAXN];</span><br><span class="line"><span class="type">int</span> n, m, q, tg[MAXN], eg[MAXN], cntt, cnte, cost[MAXM], lazy[MAXN], b[MAXL], dqk[MAXK];</span><br><span class="line"><span class="type">bool</span> ist[MAXM], vis[MAXN];</span><br><span class="line">pii pb[MAXM];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(edg* bx, <span class="type">int</span>* gx, <span class="type">int</span>&amp; cntx, <span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> bh)</span> </span>&#123;</span><br><span class="line">    bx[++cntx].next = gx[from];</span><br><span class="line">    bx[cntx].from = from, bx[cntx].to = to, bx[cntx].bh = bh;</span><br><span class="line">    gx[from] = cntx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    ta[dq].size = <span class="number">1</span>;</span><br><span class="line">    vis[dq] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = eg[dq]; i; i = eb[i].next)</span><br><span class="line">        <span class="keyword">if</span> (!vis[eb[i].to]) &#123;</span><br><span class="line">            ta[eb[i].to].deep = ta[dq].deep + <span class="number">1</span>;</span><br><span class="line">            ta[eb[i].to].fa = dq;</span><br><span class="line">            <span class="built_in">adn</span>(tb, tg, cntt, dq, eb[i].to, eb[i].bh);</span><br><span class="line">            ist[eb[i].bh] = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">init</span>(eb[i].to);</span><br><span class="line">            ta[dq].size += ta[eb[i].to].size;</span><br><span class="line">            <span class="keyword">if</span> (ta[eb[i].to].size &gt; ta[ta[dq].hs].size) ta[dq].hs = eb[i].to;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ta[dq].hs) ta[ta[dq].hs].top = ta[dq].top, <span class="built_in">dfs</span>(ta[dq].hs);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tg[dq]; i; i = tb[i].next)</span><br><span class="line">        <span class="keyword">if</span> (tb[i].to != ta[dq].hs &amp;&amp; tb[i].to != ta[dq].fa)</span><br><span class="line">            ta[tb[i].to].top = tb[i].to, <span class="built_in">dfs</span>(tb[i].to);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (ta[x].top != ta[y].top) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ta[ta[x].top].deep &lt; ta[ta[y].top].deep) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        x = ta[ta[x].top].fa;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ta[x].deep &gt; ta[y].deep) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xg</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tg[dq]; i; i = tb[i].next) &#123;</span><br><span class="line">        <span class="built_in">xg</span>(tb[i].to);</span><br><span class="line">        lazy[dq] ^= (cost[tb[i].bh] = lazy[tb[i].to]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1ll</span> &lt;&lt; i) &amp; x) &#123;</span><br><span class="line">            <span class="keyword">if</span> (b[i]) x ^= b[i];</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                b[i] = x;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">20020522</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;pb[i].first, &amp;pb[i].second), <span class="built_in">adn</span>(eb, eg, cnte, pb[i].first, pb[i].second, i), <span class="built_in">adn</span>(eb, eg, cnte, pb[i].second, pb[i].first, i);</span><br><span class="line">    ta[<span class="number">1</span>].fa = ta[<span class="number">1</span>].top = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">init</span>(<span class="number">1</span>), <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="keyword">if</span> (!ist[i]) &#123;</span><br><span class="line">            cost[i] = <span class="built_in">rand</span>();</span><br><span class="line">            <span class="type">int</span> lcaxy = <span class="built_in">lca</span>(pb[i].first, pb[i].second);</span><br><span class="line">            lazy[pb[i].first] ^= cost[i], lazy[pb[i].second] ^= cost[i];</span><br><span class="line">            <span class="keyword">if</span> (lcaxy != pb[i].first &amp;&amp; lcaxy != pb[i].second) lazy[lcaxy] ^= cost[i];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">xg</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, sumans = <span class="number">0</span>; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;dqk[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= dqk[<span class="number">0</span>]; j++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;dqk[j]);</span><br><span class="line">        <span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="built_in">sizeof</span>(b));</span><br><span class="line">        <span class="type">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>, srx; j &lt;= dqk[<span class="number">0</span>]; j++) &#123;</span><br><span class="line">            srx = dqk[j], srx ^= sumans;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">ins</span>(cost[srx])) &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Disconnected&quot;</span>);</span><br><span class="line">                ok = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ok)</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Connected&quot;</span>), ++sumans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cqoi2013新nim游戏"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3105">[cqoi2013]新Nim游戏</a></h3>
<p>首先我们知道 对于普通Nim游戏
所有的石子数量异或起来如果是0就先手必败</p>
<p>也就是说我们要让第二个人拿完几堆之后 异或和不为0</p>
<p>考虑线性基插入的时候 不能插入的数
就是异或和为0的子集的"关键元素"(没了他就异或不出0来)</p>
<p>所以我们只需要把这些不能插入线性基的数删掉就好了</p>
<p>因为答案要求尽量小 所以我们把数从小到大插入即可</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3105</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:4 ms</span></span><br><span class="line"><span class="comment">    Memory:1292 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXL (32 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> a[MAXN], n, b[MAXL];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> dans = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1ll</span> &lt;&lt; i) &amp; x) &#123;</span><br><span class="line">            <span class="keyword">if</span> (b[i]) x ^= b[i];</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                b[i] = x;</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ans += dans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">ins</span>(a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="再见xor"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=4269">4269:
再见Xor</a></h3>
<p>放在这里记录一个结论
线性基能异或出的次大值就是不异或最后一个基底的最大值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 4269</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:252 ms</span></span><br><span class="line"><span class="comment">    Memory:1288 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXL (35)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> b[MAXL], n;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (x &amp; (<span class="number">1ll</span> &lt;&lt; i)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (b[i]) x ^= b[i];</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                b[i] = x;</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx), <span class="built_in">ins</span>(srx);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, ans ^ b[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAXL; i++)</span><br><span class="line">        <span class="keyword">if</span> (b[i]) &#123;</span><br><span class="line">            ans ^= b[i];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="poi2003sums"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=2612">[Poi2003]Sums</a></h3>
<p>这题很有意思</p>
<p>先说结论: 把<span class="math inline">\(\{a\}\)</span>从小到大排序
对于<span class="math inline">\(x \in [0, a_1 -
1]\)</span>中的每一个<span
class="math inline">\(x\)</span>计算出[最小的模<span
class="math inline">\(a_1\)</span>后等于<span
class="math inline">\(x\)</span>的数<span
class="math inline">\(dis_x\)</span>], 然后对于每一个询问<span
class="math inline">\(b_i\)</span>, 如果<span
class="math inline">\(dis_{b_i \% a_1} &gt;
b_i\)</span>就是<code>NIE</code>, 否则就是<code>TAK</code></p>
<p>首先 一个很显然的结论就是 如果<span
class="math inline">\(b_x\)</span>能被凑出来 那么<span
class="math inline">\(b_x + na_y\)</span>也可以被凑出来</p>
<p>所以如果<span class="math inline">\(b\%a_1\)</span>能凑出来 <span
class="math inline">\(b\)</span>就也一定能凑出来</p>
<p>那么为什么<span class="math inline">\(b \% a_1\)</span>大于<span
class="math inline">\(b\)</span>就凑不出来呢? 废话这个都大于<span
class="math inline">\(b\)</span>了还怎么往上面加数</p>
<p>那么为什么只用试一个<span class="math inline">\(a_1\)</span>呢?
基本和上面的理由一样 因为其他的<span
class="math inline">\(a\)</span>无非就是看上去多了几个<span
class="math inline">\(dis\)</span>, 然而这些<span
class="math inline">\(dis\)</span>在刚才的做法里也是有的(算到<span
class="math inline">\(\mod a_1\)</span>之后的下标上了),
所以根据上面的那一条 较小的<span
class="math inline">\(a_1\)</span>都凑不出来 其他的<span
class="math inline">\(a\)</span>就也一定凑不出来</p>
<p>据说存边会炸空间</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 2612</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:384 ms</span></span><br><span class="line"><span class="comment">    Memory:2068 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (50000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF (0x7ffffffffffffll)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int, LL&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="type">const</span> pii x, <span class="type">const</span> pii y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x.second &gt; y.second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, a[MAXN];</span><br><span class="line">LL dis[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> vis[MAXN];</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x7f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    priority_queue&lt;pii, vector&lt;pii&gt;, cmp&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(<span class="number">0</span>, dis[<span class="number">0</span>] = <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> dq = q.<span class="built_in">top</span>().first;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (vis[dq]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[dq] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) </span><br><span class="line">            <span class="keyword">if</span> (dis[dq] + a[i] &lt; dis[(dq + a[i]) % a[<span class="number">1</span>]])</span><br><span class="line">                q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>((dq + a[i]) % a[<span class="number">1</span>], dis[(dq + a[i]) % a[<span class="number">1</span>]] = dis[dq] + a[i]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dijk</span>();</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx; i &lt;= q; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;srx), <span class="built_in">puts</span>(dis[srx % a[<span class="number">1</span>]] &lt;= srx ? <span class="string">&quot;TAK&quot;</span> : <span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="hnoi2012矿场搭建"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=2730">[HNOI2012]矿场搭建</a></h3>
<p>我怎么老是记得我好像写过这题... = =</p>
<p>这题我已经不想说啥了...
先是Tarjan求割点写了个假板子...然后统计有几个联通块连着几个割点的时候又自闭了</p>
<p>后来直接大力<code>set&lt;int&gt; []</code>终于过了...哦对了我中间还忘清数组了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 2730</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:44 ms</span></span><br><span class="line"><span class="comment">    Memory:1632 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (5000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next;</span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> g[MAXN], cntb, n, m, dfn[MAXN], low[MAXN], cntdfn, size[MAXN], fa[MAXN];</span><br><span class="line"><span class="type">bool</span> isc[MAXN];</span><br><span class="line">set&lt;<span class="type">int</span>&gt; fuck[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; cpoint;</span><br><span class="line">LL ans1, ans2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    b[++cntb].next = g[from];</span><br><span class="line">    b[cntb].from = from, b[cntb].to = to;</span><br><span class="line">    g[from] = cntb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> dq, <span class="type">bool</span> isroot)</span> </span>&#123;</span><br><span class="line">    low[dq] = dfn[dq] = ++cntdfn;</span><br><span class="line">    <span class="type">int</span> cntc = <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> ok = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = b[i].next)</span><br><span class="line">        <span class="keyword">if</span> (b[i].to != fa[dq]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dfn[b[i].to]) low[dq] = <span class="built_in">min</span>(low[dq], dfn[b[i].to]);</span><br><span class="line">            <span class="keyword">else</span> fa[b[i].to] = dq, ++cntc, <span class="built_in">tarjan</span>(b[i].to, <span class="literal">false</span>), low[dq] = <span class="built_in">min</span>(low[dq], low[b[i].to]), ok |= (low[b[i].to] &gt;= dfn[dq] &amp;&amp; !isroot);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> ((isroot &amp;&amp; cntc &gt; <span class="number">1</span>) || ok)</span><br><span class="line">        isc[dq] = <span class="literal">true</span>, cpoint.<span class="built_in">push_back</span>(dq);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    size[dq] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = b[i].next)</span><br><span class="line">        <span class="keyword">if</span> (!size[b[i].to] &amp;&amp; !isc[b[i].to]) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(b[i].to);</span><br><span class="line">            size[dq] += size[b[i].to];</span><br><span class="line">            fuck[dq].<span class="built_in">insert</span>(fuck[b[i].to].<span class="built_in">begin</span>(), fuck[b[i].to].<span class="built_in">end</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (isc[b[i].to])</span><br><span class="line">            fuck[dq].<span class="built_in">insert</span>(b[i].to);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> casei)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!dfn[i])</span><br><span class="line">            fa[i] = i, <span class="built_in">tarjan</span>(i, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">if</span> (!cpoint.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d: 2 %d\n&quot;</span> ,casei, n * (n - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (!size[i] &amp;&amp; !isc[i]) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(i);</span><br><span class="line">            <span class="keyword">if</span> (fuck[i].<span class="built_in">size</span>() == <span class="number">1</span>)</span><br><span class="line">                ++ans1, ans2 *= size[i];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Case %d: %lld %lld\n&quot;</span>, casei, ans1, ans2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> cntc = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(isc, <span class="literal">false</span>, <span class="built_in">sizeof</span>(isc));</span><br><span class="line">        <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="built_in">sizeof</span>(g));</span><br><span class="line">        <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="built_in">sizeof</span>(dfn));</span><br><span class="line">        <span class="built_in">memset</span>(low, <span class="number">0</span>, <span class="built_in">sizeof</span>(low));</span><br><span class="line">        <span class="built_in">memset</span>(size, <span class="number">0</span>, <span class="built_in">sizeof</span>(size));</span><br><span class="line">        <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="built_in">sizeof</span>(fa));</span><br><span class="line">        cpoint.<span class="built_in">clear</span>();</span><br><span class="line">        cntb = n = m = cntdfn = <span class="number">0</span>;</span><br><span class="line">        ans1 = <span class="number">0</span>, ans2 = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">        <span class="keyword">if</span> (!m) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt;= m; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">adn</span>(srx, sry), <span class="built_in">adn</span>(sry, srx), n = <span class="built_in">max</span>(n, <span class="built_in">max</span>(srx, sry));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fuck[i].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">solve</span>(++cntc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="pa2010-riddle"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3495">PA2010
Riddle</a></h3>
<p>Emmmmm...显然是个2SAT
然后我们发现这个玩意处理同一个郡内的关系的时候边数爆炸了</p>
<p><del>联想一下这题的标签</del>
我们发现这个东西就是对于每一个点都要找一个点
连向这个郡内出了当前的点的所有点的反点</p>
<p>我们又发现 刨去这个点<span class="math inline">\(city_x\)</span>后,
郡被分成了两个区间 <span class="math inline">\([1, city_x - 1] \cup
[city_x + 1, city_0]\)</span></p>
<p>我们又发现 这个东西是个前缀和的样子 于是 我们就对每个点
新建一个点连向两边的前缀/后缀区间所代表的点即可</p>
<p>本机会爆栈... = = b站上28s卡过去的...很真实</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3495</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:28460 ms</span></span><br><span class="line"><span class="comment">    Memory:346760 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (10000000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> bh(i) (1000000 + (i))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> jbh(i) (2000000 + (i))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next;</span><br><span class="line">&#125; b[MAXN];</span><br><span class="line"><span class="type">int</span> g[MAXN], n, m, k, cntb, belong[MAXN], low[MAXN], dfn[MAXN], cntdfn, city[MAXN];</span><br><span class="line"><span class="type">bool</span> ins[MAXN];</span><br><span class="line">stack&lt;<span class="type">int</span>&gt; gary;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    b[++cntb].next = g[from];</span><br><span class="line">    b[cntb].from = from, b[cntb].to = to;</span><br><span class="line">    g[from] = cntb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    low[dq] = dfn[dq] = ++cntdfn;</span><br><span class="line">    belong[dq] = dq;</span><br><span class="line">    gary.<span class="built_in">push</span>(dq);</span><br><span class="line">    ins[dq] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = b[i].next)</span><br><span class="line">        <span class="keyword">if</span> (!dfn[b[i].to]) <span class="built_in">tarjan</span>(b[i].to), low[dq] = <span class="built_in">min</span>(low[dq], low[b[i].to]); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ins[b[i].to]) low[dq] = <span class="built_in">min</span>(low[dq], dfn[b[i].to]);</span><br><span class="line">    <span class="keyword">if</span> (low[dq] == dfn[dq]) &#123;</span><br><span class="line">        <span class="keyword">while</span> (!gary.<span class="built_in">empty</span>() &amp;&amp; gary.<span class="built_in">top</span>() != dq) ins[gary.<span class="built_in">top</span>()] = <span class="literal">false</span>, belong[gary.<span class="built_in">top</span>()] = dq, gary.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (!gary.<span class="built_in">empty</span>())</span><br><span class="line">            gary.<span class="built_in">pop</span>();</span><br><span class="line">        ins[dq] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">adn</span>(<span class="built_in">bh</span>(srx), sry), <span class="built_in">adn</span>(<span class="built_in">bh</span>(sry), srx);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, cntc = <span class="number">0</span>; i &lt;= k; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;city[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= city[<span class="number">0</span>]; j++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;city[j]);</span><br><span class="line">        <span class="built_in">adn</span>(<span class="built_in">jbh</span>(++cntc), <span class="built_in">bh</span>(city[<span class="number">1</span>]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">2</span>; j &lt;= city[<span class="number">0</span>]; j++) <span class="built_in">adn</span>(<span class="built_in">jbh</span>(++cntc), <span class="built_in">bh</span>(city[j])), <span class="built_in">adn</span>(<span class="built_in">jbh</span>(cntc), <span class="built_in">jbh</span>(cntc - <span class="number">1</span>)), <span class="built_in">adn</span>(city[j], <span class="built_in">jbh</span>(cntc - <span class="number">1</span>));</span><br><span class="line">        <span class="built_in">adn</span>(<span class="built_in">jbh</span>(++cntc), <span class="built_in">bh</span>(city[city[<span class="number">0</span>]]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = city[<span class="number">0</span>] - <span class="number">1</span>; j &gt;= <span class="number">1</span>; j--) <span class="built_in">adn</span>(<span class="built_in">jbh</span>(++cntc), <span class="built_in">bh</span>(city[j])), <span class="built_in">adn</span>(<span class="built_in">jbh</span>(cntc), <span class="built_in">jbh</span>(cntc - <span class="number">1</span>)), <span class="built_in">adn</span>(city[j], <span class="built_in">jbh</span>(cntc - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">        <span class="keyword">if</span> (!dfn[i])</span><br><span class="line">            <span class="built_in">tarjan</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (belong[i] == belong[<span class="built_in">bh</span>(i)]) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;NIE&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;TAK&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="tjoi2018xor"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=5338">[TJOI2018]xor</a></h3>
<p>树链剖分套可持久化trie</p>
<p>一开始想第一问启发式合并然后第二问在树上建可持久化trie</p>
<p>然后没过一会就真香了... = =</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 5338</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:4584 ms</span></span><br><span class="line"><span class="comment">    Memory:94188 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int LL</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXL (30 + 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LS(dq) ((dq) &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RS(dq) (LS(dq) | 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> ch[<span class="number">2</span>], zh;</span><br><span class="line">&#125; b[MAXN &lt;&lt; <span class="number">5</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next;</span><br><span class="line">&#125; tb[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tnode</span> &#123;</span><br><span class="line">    <span class="type">int</span> begin, end, top, fa, size, hs, deep;</span><br><span class="line">&#125; ta[MAXN];</span><br><span class="line"><span class="type">int</span> tg[MAXN], cntt, cntb, n, root[MAXN], cnta, a[MAXN], zh[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    tb[++cntt].next = tg[from];</span><br><span class="line">    tb[cntt].from = from, tb[cntt].to = to;</span><br><span class="line">    tg[from] = cntt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    ta[dq].size = <span class="number">1</span>;</span><br><span class="line">    ta[dq].deep = ta[ta[dq].fa].deep + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tg[dq]; i; i = tb[i].next)</span><br><span class="line">        <span class="keyword">if</span> (tb[i].to != ta[dq].fa)</span><br><span class="line">            ta[tb[i].to].fa = dq, <span class="built_in">init</span>(tb[i].to), ta[dq].size += ta[tb[i].to].size, ta[dq].hs = (ta[ta[dq].hs].size &gt; ta[tb[i].to].size) ? ta[dq].hs : tb[i].to;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    a[ta[dq].begin = ++cnta] = dq;</span><br><span class="line">    <span class="keyword">if</span> (ta[dq].hs) ta[ta[dq].hs].top = ta[dq].top, <span class="built_in">dfs</span>(ta[dq].hs);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tg[dq]; i; i = tb[i].next)</span><br><span class="line">        <span class="keyword">if</span> (tb[i].to != ta[dq].fa &amp;&amp; tb[i].to != ta[dq].hs)</span><br><span class="line">            ta[tb[i].to].top = tb[i].to, <span class="built_in">dfs</span>(tb[i].to);</span><br><span class="line">    ta[dq].end = cnta;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> ++cntb; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> pre, <span class="type">int</span> dq, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">bool</span> isright = (x &amp; (<span class="number">1ll</span> &lt;&lt; i)) != <span class="number">0</span>;</span><br><span class="line">        b[dq].ch[isright] = <span class="built_in">newnode</span>();</span><br><span class="line">        b[b[dq].ch[isright]].zh = b[b[pre].ch[isright]].zh + <span class="number">1</span>;</span><br><span class="line">        b[dq].ch[!isright] = b[pre].ch[!isright];</span><br><span class="line">        dq = b[dq].ch[isright], pre = b[pre].ch[isright];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cx</span><span class="params">(<span class="type">int</span> pre, <span class="type">int</span> dq, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> re = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">bool</span> isright = (x &amp; (<span class="number">1ll</span> &lt;&lt; i)) == <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (b[b[dq].ch[isright]].zh - b[b[pre].ch[isright]].zh) re |= (<span class="number">1ll</span> &lt;&lt; i), dq = b[dq].ch[isright], pre = b[pre].ch[isright];</span><br><span class="line">        <span class="keyword">else</span> dq = b[dq].ch[!isright], pre = b[pre].ch[!isright];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">cx</span>(root[ta[x].begin - <span class="number">1</span>], root[ta[x].end], y); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> re = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ta[x].top != ta[y].top) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ta[ta[x].top].deep &lt; ta[ta[y].top].deep) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        re = <span class="built_in">max</span>(re, <span class="built_in">cx</span>(root[ta[ta[x].top].begin - <span class="number">1</span>], root[ta[x].begin], z));</span><br><span class="line">        x = ta[ta[x].top].fa;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ta[x].deep &gt; ta[y].deep) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    re = <span class="built_in">max</span>(re, <span class="built_in">cx</span>(root[ta[x].begin - <span class="number">1</span>], root[ta[y].begin], z));</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">main</span>() &#123;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;zh[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">adn</span>(srx, sry), <span class="built_in">adn</span>(sry, srx);</span><br><span class="line">    ta[<span class="number">1</span>].fa = ta[<span class="number">1</span>].top = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">init</span>(<span class="number">1</span>), <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">ins</span>(root[i - <span class="number">1</span>], root[i] = <span class="built_in">newnode</span>(), zh[a[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, sre, srx, sry, srz; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;sre);</span><br><span class="line">        <span class="keyword">if</span> (sre == <span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">solve</span>(srx, sry));</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;srx, &amp;sry, &amp;srz), <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">solve</span>(srx, sry, srz));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="hnoi2015菜肴制作"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=4010">[HNOI2015]菜肴制作</a></h3>
<p>这题挺有意思...一开始以为是直接正着拓扑排序 把队列换成堆就行了</p>
<p>后来发现题目要求的是"编号小的尽量靠前" 而不是 "字典序最小"</p>
<p>这两个玩意是有区别的:</p>
<p>字典序最小是要让第一位尽量小 然后再让第二位尽量小...</p>
<p>编号小的靠前是宁愿让第一位大一些 也要把编号小的挪到前面去</p>
<p>搞清楚这两个的区别就很好理(意)解(会)为什么要建反图了(因为编号大的数为了凑字典序都跑到后面取了)
(估计这题在当时会坑不少人?)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 4010</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:1060 ms</span></span><br><span class="line"><span class="comment">    Memory:4276 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next;</span><br><span class="line">&#125; b[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="type">const</span> <span class="type">int</span> x, <span class="type">const</span> <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> x &lt; y; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> g[MAXN], cntb, n, m, du[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; outp;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    b[++cntb].next = g[from];</span><br><span class="line">    b[cntb].from = from, b[cntb].to = to;</span><br><span class="line">    g[from] = cntb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, cmp&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (!du[i]) q.<span class="built_in">push</span>(i);</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> dq = q.<span class="built_in">top</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        outp.<span class="built_in">push_back</span>(dq);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = b[i].next) &#123;</span><br><span class="line">            --du[b[i].to];</span><br><span class="line">            <span class="keyword">if</span> (!du[b[i].to])</span><br><span class="line">                q.<span class="built_in">push</span>(b[i].to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (outp.<span class="built_in">size</span>() != n) <span class="built_in">puts</span>(<span class="string">&quot;Impossible!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, outp[i]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="built_in">memset</span>(du, <span class="number">0</span>, <span class="built_in">sizeof</span>(du));</span><br><span class="line">        <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="built_in">sizeof</span>(g));</span><br><span class="line">        cntb = <span class="number">0</span>;</span><br><span class="line">        outp.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt;= m; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">adn</span>(sry, srx), ++du[srx];</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="树上三角形"><a
target="_blank" rel="noopener" href="https://lydsy.com/JudgeOnline/problem.php?id=3251">树上三角形</a></h3>
<p>这题也挺有意思的 当时我<del>熬夜肝For Honor所以</del>上课昏昏沉沉的
然后就听学长说 "你倒过来想一下 这个路径不能构成三角形是什么情况"</p>
<p>我一想 不能构成三角形最少不就是个斐波那契数列吗
这个说爆<code>int</code>很快啊</p>
<p>于是我们发现斐波那契数列到第<span
class="math inline">\(50\)</span>项左右就爆<code>int</code>了...</p>
<p>所以我们对于点数大于<span
class="math inline">\(50\)</span>的路径直接输出<code>Y</code>就行</p>
<p>当然节点数小于<span
class="math inline">\(50\)</span>的就可以直接暴力算了...</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 3251</span></span><br><span class="line"><span class="comment">    User: Cansult</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:1004 ms</span></span><br><span class="line"><span class="comment">    Memory:50956 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN (100000 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXL (50 + 5)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int LL </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edg</span> &#123;</span><br><span class="line">    <span class="type">int</span> from, to, next;</span><br><span class="line">&#125; b[MAXN];</span><br><span class="line"><span class="type">int</span> g[MAXN], cntb, n, deep[MAXN], zh[MAXN], d[MAXN][MAXL];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adn</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to)</span> </span>&#123;</span><br><span class="line">    b[++cntb].next = g[from];</span><br><span class="line">    b[cntb].from = from, b[cntb].to = to;</span><br><span class="line">    g[from] = cntb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> dq)</span> </span>&#123;</span><br><span class="line">    deep[dq] = deep[d[dq][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXL; i++) d[dq][i] = d[d[dq][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g[dq]; i; i = b[i].next) <span class="built_in">dfs</span>(b[i].to);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (deep[x] &lt; deep[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (deep[d[x][i]] &gt;= deep[y])</span><br><span class="line">            x = d[x][i];</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXL - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (d[x][i] != d[y][i])</span><br><span class="line">            x = d[x][i], y = d[y][i];</span><br><span class="line">    <span class="keyword">return</span> d[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">main</span>() &#123;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;zh[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, srx, sry; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;srx, &amp;sry), <span class="built_in">adn</span>(srx, sry), d[sry][<span class="number">0</span>] = srx;</span><br><span class="line">    d[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, sre, srx, sry; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;sre, &amp;srx, &amp;sry);</span><br><span class="line">        <span class="keyword">if</span> (sre) zh[srx] = sry;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> lcaxy = <span class="built_in">lca</span>(srx, sry);</span><br><span class="line">            <span class="keyword">if</span> (deep[sry] + deep[srx] - <span class="number">2</span> * deep[lcaxy] &gt; MAXL) <span class="built_in">puts</span>(<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                vector&lt;<span class="type">int</span>&gt; dq;</span><br><span class="line">                <span class="keyword">while</span> (srx != lcaxy) dq.<span class="built_in">push_back</span>(zh[srx]), srx = d[srx][<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">while</span> (sry != lcaxy) dq.<span class="built_in">push_back</span>(zh[sry]), sry = d[sry][<span class="number">0</span>];</span><br><span class="line">                dq.<span class="built_in">push_back</span>(zh[lcaxy]);</span><br><span class="line">                <span class="built_in">sort</span>(dq.<span class="built_in">begin</span>(), dq.<span class="built_in">end</span>());</span><br><span class="line">                <span class="keyword">if</span> (dq.<span class="built_in">size</span>() &lt; <span class="number">3</span>) <span class="built_in">puts</span>(<span class="string">&quot;N&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="type">bool</span> ok = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; dq.<span class="built_in">size</span>(); i++) </span><br><span class="line">                        <span class="keyword">if</span> (dq[i] &lt; dq[i - <span class="number">1</span>] + dq[i - <span class="number">2</span>]) &#123;</span><br><span class="line">                            ok = <span class="literal">true</span>;</span><br><span class="line">                            <span class="built_in">puts</span>(<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">if</span> (!ok) <span class="built_in">puts</span>(<span class="string">&quot;N&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>By 准备退役旅游的 Cansult</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E6%B8%85%E5%A5%87%E8%84%91%E5%9B%9E%E8%B7%AF/" rel="tag"><i class="fa fa-tag"></i> 清奇脑回路</a>
              <a href="/tags/%E6%9D%82%E9%A2%98/" rel="tag"><i class="fa fa-tag"></i> 杂题</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/37546.html" rel="prev" title="学习笔记 虚树">
      <i class="fa fa-chevron-left"></i> 学习笔记 虚树
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/55261.html" rel="next" title="翻车笔记 ProjectEuler 总结">
      翻车笔记 ProjectEuler 总结 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#section"><span class="nav-number">1.</span> <span class="nav-text">19</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E9%A2%98"><span class="nav-number">1.1.</span> <span class="nav-text">简单题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#preprefix-sum"><span class="nav-number">1.2.</span> <span class="nav-text">Preprefix
sum</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jsoi2009%E7%AD%89%E5%B7%AE%E6%95%B0%E5%88%97"><span class="nav-number">1.3.</span> <span class="nav-text">[JSOI2009]等差数列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poi2010intelligence-test"><span class="nav-number">1.4.</span> <span class="nav-text">[Poi2010]Intelligence
test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#count"><span class="nav-number">1.5.</span> <span class="nav-text">Count</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%97%E9%A9%AC%E6%B8%B8%E6%88%8F"><span class="nav-number">1.6.</span> <span class="nav-text">罗马游戏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tjoi2012-%E6%A1%A5"><span class="nav-number">1.7.</span> <span class="nav-text">tjoi2012
桥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poi2012warehouse-store"><span class="nav-number">1.8.</span> <span class="nav-text">[Poi2012]Warehouse
Store</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poi2018prawnicy"><span class="nav-number">1.9.</span> <span class="nav-text">[POI2018]Prawnicy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#noi2002savage"><span class="nav-number">1.10.</span> <span class="nav-text">[Noi2002]Savage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dzy-loves-chinese-ii"><span class="nav-number">1.11.</span> <span class="nav-text">DZY Loves
Chinese II</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cqoi2013%E6%96%B0nim%E6%B8%B8%E6%88%8F"><span class="nav-number">1.12.</span> <span class="nav-text">[cqoi2013]新Nim游戏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%8D%E8%A7%81xor"><span class="nav-number">1.13.</span> <span class="nav-text">4269:
再见Xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poi2003sums"><span class="nav-number">1.14.</span> <span class="nav-text">[Poi2003]Sums</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hnoi2012%E7%9F%BF%E5%9C%BA%E6%90%AD%E5%BB%BA"><span class="nav-number">1.15.</span> <span class="nav-text">[HNOI2012]矿场搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pa2010-riddle"><span class="nav-number">1.16.</span> <span class="nav-text">PA2010
Riddle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tjoi2018xor"><span class="nav-number">1.17.</span> <span class="nav-text">[TJOI2018]xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hnoi2015%E8%8F%9C%E8%82%B4%E5%88%B6%E4%BD%9C"><span class="nav-number">1.18.</span> <span class="nav-text">[HNOI2015]菜肴制作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E4%B8%8A%E4%B8%89%E8%A7%92%E5%BD%A2"><span class="nav-number">1.19.</span> <span class="nav-text">树上三角形</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Cansult Chen"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Cansult Chen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Cansult" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Cansult" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cansult Chen</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
